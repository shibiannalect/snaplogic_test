{"class_fqid":"com-snaplogic-pipeline_9","instance_version":56,"link_serial":120,"path_id":"/OmnicomDev/projects/Shibi Prabhu","property_map":{"info":{"label":{"value":"SAP_MANAGECUSTOMER"},"author":{"value":"shibi.prabhu@flywheeldigital.com"},"pipeline_doc_uri":{"value":null},"notes":{"value":null},"purpose":{"value":null}},"error":{"ff7ee3cf-7781-4297-b28f-fcc7b527a64d_error0":{"view_type":{"value":"document"},"label":{"value":"Pipeline Execute - error0"}},"error_behavior":{"value":"none"}},"settings":{"error_pipeline":{"value":null,"expression":false},"error_param_table":{"value":[]},"param_table":{"value":[{"capture":{"value":false},"key":{"value":"LineCount"},"value":{"value":"10000"},"required":{"value":false},"data_type":{"value":"string"},"description":{"value":null}}]},"imports":{"value":[]}},"instance_version":55,"input":{},"output":{"fba345ff-7f95-40fe-b5cb-0f312c610bf6_output0":{"view_type":{"value":"document"},"label":{"value":"Sum of Records - output0"}}}},"render_map":{"scale_ratio":1,"pan_x_num":0,"pan_y_num":0,"default_snaplex":"66ab5aac86801df4cd2cfc05","detail_map":{"5f14a1ef-e053-470e-a4fc-1737da4ded3f":{"grid_x_int":5,"grid_y_int":2,"rot_int":0,"recommendation_id":null,"source":"","index":null,"rot_tail_int":0},"ff7ee3cf-7781-4297-b28f-fcc7b527a64d":{"grid_x_int":6,"grid_y_int":2,"rot_int":0,"recommendation_id":null,"source":"","index":null,"rot_tail_int":0,"error":{"error0":{"rot_int":0,"dx_int":0,"dy_int":-1}}},"8c37a58c-8328-421d-865d-2e2d095f4a18":{"grid_x_int":7,"grid_y_int":2,"rot_int":0,"recommendation_id":null,"source":"snap catagory","index":null,"rot_tail_int":0},"fba345ff-7f95-40fe-b5cb-0f312c610bf6":{"grid_x_int":8,"grid_y_int":2,"rot_int":0,"recommendation_id":null,"source":"snap catagory","index":null,"rot_tail_int":0},"cc33894d-d30f-4c49-86ad-67971a0c0577":{"grid_x_int":3,"grid_y_int":2,"rot_int":0,"recommendation_id":null,"source":"snap catagory","index":null,"rot_tail_int":0,"input":{}},"332dd719-9c9a-4687-8737-8b7bf39ca62e":{"grid_x_int":4,"grid_y_int":2,"rot_int":0,"recommendation_id":null,"source":"snap catagory","index":null,"rot_tail_int":0}}},"snap_map":{"5f14a1ef-e053-470e-a4fc-1737da4ded3f":{"class_fqid":"com-snaplogic-snaps-script-script_2-main29887","class_id":"com-snaplogic-snaps-script-script","class_version":2,"instance_fqid":"5f14a1ef-e053-470e-a4fc-1737da4ded3f_10","instance_version":10,"property_map":{"info":{"label":{"value":"Top and Split"},"notes":{}},"input":{"input0":{"view_type":{"value":"document"},"label":{"value":"input0"}}},"output":{"output0":{"view_type":{"value":"document"},"label":{"value":"output0"}}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"ignore"}},"settings":{"execution_mode":{"value":"Validate & Execute"},"executable_during_suggest":{"value":false},"language":{"value":"Python"},"script":{"value":null,"expression":false},"editable_content":{"value":"from com.snaplogic.scripting.language import ScriptHook\r\n\r\nclass TransformScript(ScriptHook):\r\n    def __init__(self, input, output, error, log):\r\n        self.input = input\r\n        self.output = output\r\n        self.error = error\r\n        self.log = log\r\n\r\n    def execute(self):\r\n        while self.input.hasNext():\r\n            try:\r\n                in_doc = self.input.next()\r\n                total_count = int(in_doc.get('total_count'))\r\n                page_size = 500000\r\n                page_count = (total_count + page_size - 1) // page_size  # Ceiling division\r\n\r\n                for i in range(page_count):\r\n                    skip = i * page_size\r\n                    top = min(page_size, total_count - skip)\r\n                    self.output.write({'top': top, 'skip': skip})\r\n            except Exception as e:\r\n                self.error.write({'error': str(e)})\r\n\r\n    def cleanup(self):\r\n        pass\r\n\r\nhook = TransformScript(input, output, error, log)"}},"view_serial":100},"class_build_tag":"main29887","instance_id":"5f14a1ef-e053-470e-a4fc-1737da4ded3f"},"ff7ee3cf-7781-4297-b28f-fcc7b527a64d":{"class_fqid":"com-snaplogic-snaps-flow-pipeexec_1-main29887","class_id":"com-snaplogic-snaps-flow-pipeexec","class_version":1,"instance_fqid":"ff7ee3cf-7781-4297-b28f-fcc7b527a64d_8","instance_version":8,"property_map":{"info":{"label":{"value":"Pipeline Execute"},"notes":{}},"input":{"input0":{"view_type":{"value":"document"},"label":{"value":"input0"}}},"output":{"output0":{"view_type":{"value":"document"},"label":{"value":"output0"}}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"continue"}},"settings":{"timeout":{"value":null,"expression":false},"pipeline":{"expression":false,"value":"CHILD - MANAGECUSTOMER"},"execLabel":{"expression":true,"value":null},"params":{"value":[{"paramValue":{"expression":true,"value":"$top"},"paramName":{"value":"top"}},{"paramName":{"value":"skip"},"paramValue":{"value":"$skip","expression":true}}]},"execution_mode":{"value":"Validate & Execute"},"snaplexGovernor":{"value":"SNAPLEX_WITH_PATH"},"retryInterval":{"value":null,"expression":false},"retryLimit":{"value":null,"expression":false},"reuse":{"value":false},"snaplex":{"expression":false},"executable_during_suggest":{"value":true},"batchSize":{"value":1,"expression":false},"poolSize":{"value":1,"expression":false},"loopDocument":{"expression":true}},"view_serial":100},"class_build_tag":"main29887","instance_id":"ff7ee3cf-7781-4297-b28f-fcc7b527a64d"},"8c37a58c-8328-421d-865d-2e2d095f4a18":{"class_fqid":"com-snaplogic-snaps-transform-datatransform_4-main29887","class_id":"com-snaplogic-snaps-transform-datatransform","class_version":4,"instance_fqid":"8c37a58c-8328-421d-865d-2e2d095f4a18_2","instance_version":2,"property_map":{"info":{"label":{"value":"Records loaded"},"notes":{}},"input":{"input0":{"view_type":{"value":"document"},"label":{"value":"input0"}}},"output":{"output0":{"view_type":{"value":"document"},"label":{"value":"output0"}}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"fail"}},"settings":{"execution_mode":{"value":"Validate & Execute"},"passThrough":{"value":false},"transformations":{"value":{"mappingRoot":{"value":"$"},"mappingTable":{"value":[{"expression":{"expression":true,"value":"parseInt($status.split(\" \")[0])"},"targetPath":{"value":"Records loaded"}}]}}},"nullSafeAccess":{"value":false}},"view_serial":100},"class_build_tag":"main29887","instance_id":"8c37a58c-8328-421d-865d-2e2d095f4a18"},"fba345ff-7f95-40fe-b5cb-0f312c610bf6":{"class_fqid":"com-snaplogic-snaps-transform-aggregate_3-main29887","class_id":"com-snaplogic-snaps-transform-aggregate","class_version":3,"instance_fqid":"fba345ff-7f95-40fe-b5cb-0f312c610bf6_3","instance_version":3,"property_map":{"info":{"label":{"value":"Sum of Records"},"notes":{}},"input":{"input0":{"view_type":{"value":"document"},"label":{"value":"input0"}}},"output":{"output0":{"view_type":{"value":"document"},"label":{"value":"output0"}}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"fail"}},"settings":{"execution_mode":{"value":"Validate & Execute"},"aggregateFields":{"value":[{"function":{"value":"SUM"},"field":{"expression":true,"value":"$['Records loaded']"},"resultField":{"value":"Total recods loaded"}}]},"integerMode":{"value":false},"sortedStreams":{"value":"Unsorted"},"minimumMemory":{"value":500,"expression":false},"outOfResourceTimeout":{"value":30,"expression":false},"groupByFields":{"value":[]}},"view_serial":100},"class_build_tag":"main29887","instance_id":"fba345ff-7f95-40fe-b5cb-0f312c610bf6"},"cc33894d-d30f-4c49-86ad-67971a0c0577":{"class_fqid":"com-snaplogic-snaps-azuresql-execute_1-main29887","class_id":"com-snaplogic-snaps-azuresql-execute","class_version":1,"instance_fqid":"cc33894d-d30f-4c49-86ad-67971a0c0577_10","instance_version":10,"property_map":{"info":{"label":{"value":"Azure SQL - Execute"},"notes":{}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"fail"}},"settings":{"sqlStatement":{"value":"drop table [dbo].[SAP PAGINATION TEST - MANAGECUSTOMER]","expression":false},"queryType":{"value":"Auto","expression":false},"autoCommit":{"value":"Use account setting"},"maxRetryProp":{"value":0,"expression":false},"execution_mode":{"value":"Validate & Execute"},"retryIntervalProp":{"value":1,"expression":false},"passThrough":{"value":true},"ignoreEmptyResult":{"value":false},"executable_during_suggest":{"value":false}},"account":{"account_ref":{"value":{"label":{"value":"Omnicom_Internal_Azure","label":"../../shared/Omnicom_Internal_Azure","expression":false},"ref_class_id":{"value":"com-snaplogic-snap-api-sql-accounts-azuresqldatabaseaccount"},"ref_id":{"value":"fb179940-0e97-4c84-b876-79905bc3111c","expression":false}}}},"view_serial":101,"input":{},"output":{"output101":{"label":{"value":"output0"},"view_type":{"value":"document"}}}},"class_build_tag":"main29887","instance_id":"cc33894d-d30f-4c49-86ad-67971a0c0577"},"332dd719-9c9a-4687-8737-8b7bf39ca62e":{"class_fqid":"com-snaplogic-snaps-transform-datatransform_4-main29887","class_id":"com-snaplogic-snaps-transform-datatransform","class_version":4,"instance_fqid":"332dd719-9c9a-4687-8737-8b7bf39ca62e_5","instance_version":5,"property_map":{"info":{"label":{"value":"Line Count"},"notes":{}},"input":{"input0":{"view_type":{"value":"document"},"label":{"value":"input0"}}},"output":{"output0":{"view_type":{"value":"document"},"label":{"value":"output0"}}},"error":{"error0":{"view_type":{"value":"document"},"label":{"value":"error0"}},"error_behavior":{"value":"fail"}},"settings":{"execution_mode":{"value":"Validate & Execute"},"passThrough":{"value":false},"transformations":{"value":{"mappingRoot":{"value":"$"},"mappingTable":{"value":[{"expression":{"expression":true,"value":"_LineCount"},"targetPath":{"value":"total_count"}}]}}},"nullSafeAccess":{"value":false}},"view_serial":100},"class_build_tag":"main29887","instance_id":"332dd719-9c9a-4687-8737-8b7bf39ca62e"}},"link_map":{"link109":{"dst_id":"8c37a58c-8328-421d-865d-2e2d095f4a18","dst_view_id":"input0","src_id":"ff7ee3cf-7781-4297-b28f-fcc7b527a64d","src_view_id":"output0"},"link110":{"dst_id":"fba345ff-7f95-40fe-b5cb-0f312c610bf6","dst_view_id":"input0","src_id":"8c37a58c-8328-421d-865d-2e2d095f4a18","src_view_id":"output0"},"link112":{"dst_id":"5f14a1ef-e053-470e-a4fc-1737da4ded3f","dst_view_id":"input0","src_id":"332dd719-9c9a-4687-8737-8b7bf39ca62e","src_view_id":"output0"},"link117":{"dst_id":"ff7ee3cf-7781-4297-b28f-fcc7b527a64d","dst_view_id":"input0","src_id":"5f14a1ef-e053-470e-a4fc-1737da4ded3f","src_view_id":"output0"},"link119":{"dst_id":"332dd719-9c9a-4687-8737-8b7bf39ca62e","dst_view_id":"input0","src_id":"cc33894d-d30f-4c49-86ad-67971a0c0577","src_view_id":"output101"}},"class_id":"com-snaplogic-pipeline","class_version":9,"instance_id":"26647a96-f32c-4ce2-ab48-cd9e70608567","instance_fqid":"26647a96-f32c-4ce2-ab48-cd9e70608567_56","create_time":"2025-04-23T08:21:01.998000+00:00","update_time":"2025-04-24T09:16:48.191000+00:00","update_user_id":"shibi.prabhu@flywheeldigital.com","create_user_id":"shibi.prabhu@flywheeldigital.com","migrate_version":"main-33084","scrub_backup":[],"scrub_version":"bd5ad2571a0eafe60808d55c3e16c0f8e0ae08d67f5369bb3ad9c1921556eb14","_id":"26647a96-f32c-4ce2-ab48-cd9e70608567","path":"/OmnicomDev/projects/Shibi Prabhu/SAP_MANAGECUSTOMER","snode_id":"6808a2ee4a428288da6ad848","project_snode_id":"66b0a1ad1391f6d3d5b1791d","partition_snode_id":"66ab5aa1ef4aa40316e99b9a","name":"SAP_MANAGECUSTOMER","target_runtime":"standard","org_id":"66ab5aa1ef4aa40316e99b98","org_snode_id":"66ab5aa1ef4aa40316e99b98","original":{"name":"SAP_MANAGECUSTOMER","owner":"shibi.prabhu@flywheeldigital.com","updated_by":"shibi.prabhu@flywheeldigital.com","time_created":"2025-04-23T08:21:02.022000+00:00","time_updated":"2025-04-24T09:16:48.191000+00:00","time_leased":null,"snode_id":"6808a2ee4a428288da6ad848","acl":[],"asset_id":"26647a96-f32c-4ce2-ab48-cd9e70608567","asset_type":"Pipeline","lease_info":{},"perms":["X","A","R","W"],"metadata":{},"parent_snode_id":"66b0a1ad1391f6d3d5b1791d","partition_snode_id":"66ab5aa1ef4aa40316e99b9a","path":"/OmnicomDev/projects/Shibi Prabhu/SAP_MANAGECUSTOMER","original":{"Source_path":"/OmnicomDev/projects/Shibi Prabhu/","Target_path":"/OmnicomDev/projects/Backedup pipelines/"}},"Project name":"SAP_MANAGECUSTOMER"}